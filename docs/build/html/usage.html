<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>How to Use PyREx &mdash; PyREx 1.10.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="_static/css/spc-extend.css">
    <link rel="stylesheet" href="_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/searchtools.js"></script>
    <script type="text/javascript" src="_static/js/copybutton.js"></script>
    <link rel="author" title="About these documents" href="about.html" >
    <link rel="index" title="Index" href="genindex.html" >
    <link rel="search" title="Search" href="search.html" >
    <link rel="top" title="PyREx 1.10.0 documentation" href="index.html" >
    <link rel="next" title="Custom Sub-Package" href="customize.html" >
    <link rel="prev" title="About PyREx" href="about.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="index.html">
      <img style="border: 0;" width="250" alt="PyREx" src="_static/logo_white_transparent.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="index.html">PyREx 1.10.0 documentation</a></li>
	 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="customize.html" title="Custom Sub-Package"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="about.html" title="About PyREx"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="how-to-use-pyrex">
<h1>How to Use PyREx<a class="headerlink" href="#how-to-use-pyrex" title="Permalink to this headline">¶</a></h1>
<p>This section describes in detail how to use a majority of the functions and classes included in the base PyREx package, along with short example code segments. The code in each section is designed to run sequentially, and the code examples all assume these imports:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.fft</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>
<span class="kn">import</span> <span class="nn">pyrex</span>
</pre></div>
</div>
<p>All of the following examples can also be found (and easily run) in the Code Examples python notebook found in the examples directory.</p>
<div class="section" id="working-with-signal-objects">
<h2>Working with Signal Objects<a class="headerlink" href="#working-with-signal-objects" title="Permalink to this headline">¶</a></h2>
<p>The base <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> class consists of an array of times and an array of corresponding signal values, and is instantiated with these two arrays. The <code class="xref py py-attr docutils literal notranslate"><span class="pre">times</span></code> array is assumed to be in units of seconds, but there are no general units for the <code class="xref py py-attr docutils literal notranslate"><span class="pre">values</span></code> array. It is worth noting that the Signal object stores shallow copies of the passed arrays, so changing the original arrays will not affect the <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">value_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time_array</span><span class="p">)</span>
<span class="n">my_signal</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">time_array</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">value_array</span><span class="p">)</span>
</pre></div>
</div>
<p>Plotting the <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> object is as simple as plotting the times vs the values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_1.png" src="_images/signal_1.png" />
<p>While there are no specified units for <code class="xref py py-attr docutils literal notranslate"><span class="pre">Signal.values</span></code>, there is the option to specify the <code class="xref py py-attr docutils literal notranslate"><span class="pre">value_type</span></code> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">values</span></code>. This is done using the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Signal.Type</span></code> enum. By default, a <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> object has <code class="docutils literal notranslate"><span class="pre">value_type=Type.unknown</span></code>. However, if the signal represents a voltage, electric field, or power; <code class="xref py py-attr docutils literal notranslate"><span class="pre">value_type</span></code> can be set to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Signal.Type.voltage</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">Signal.Type.field</span></code>, or <code class="xref py py-attr docutils literal notranslate"><span class="pre">Signal.Type.power</span></code> respectively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_voltage_signal</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">time_array</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">value_array</span><span class="p">,</span>
                                 <span class="n">value_type</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">voltage</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> objects can be added as long as they have the same time array and <code class="xref py py-attr docutils literal notranslate"><span class="pre">value_type</span></code>. <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> objects can also be multiplied by numeric types, which will multiply the <code class="xref py py-attr docutils literal notranslate"><span class="pre">values</span></code> attribute of the signal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">values1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">time_array</span><span class="p">)</span>
<span class="n">values2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">time_array</span><span class="p">)</span>
<span class="n">signal1</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">time_array</span><span class="p">,</span> <span class="n">values1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal1</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">signal1</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;signal1 = sin(t)&quot;</span><span class="p">)</span>
<span class="n">signal2</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">time_array</span><span class="p">,</span> <span class="n">values2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal2</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">signal2</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;signal2 = cos(t)&quot;</span><span class="p">)</span>
<span class="n">signal3</span> <span class="o">=</span> <span class="n">signal1</span> <span class="o">+</span> <span class="n">signal2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal3</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">signal3</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;signal3 = sin(t)+cos(t)&quot;</span><span class="p">)</span>
<span class="n">signal4</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">signal3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal4</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">signal4</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;signal4 = 2*(sin(t)+cos(t))&quot;</span><span class="p">)</span>
<span class="n">all_signals</span> <span class="o">=</span> <span class="p">[</span><span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">signal3</span><span class="p">]</span>
<span class="n">signal5</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">all_signals</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal5</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">signal5</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;signal5 = 2*(sin(t)+cos(t))&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_2.png" src="_images/signal_2.png" />
<p>The <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> class provides many convenience attributes for dealing with signals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_signal</span><span class="o">.</span><span class="n">dt</span> <span class="o">==</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">my_signal</span><span class="o">.</span><span class="n">spectrum</span> <span class="o">==</span> <span class="n">scipy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">my_signal</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">my_signal</span><span class="o">.</span><span class="n">frequencies</span> <span class="o">==</span> <span class="n">scipy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">my_signal</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                                           <span class="n">d</span><span class="o">=</span><span class="n">my_signal</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="n">my_signal</span><span class="o">.</span><span class="n">envelope</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">hilbert</span><span class="p">(</span><span class="n">my_signal</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> class also provides methods for manipulating the signal. The <a class="reference internal" href="docstrings/pyrex.Signal.resample.html#pyrex.Signal.resample" title="pyrex.Signal.resample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signal.resample()</span></code></a> method will resample the times and values arrays to the given number of points (with the same endpoints). This method operates “in-place” on the signal, but we can use the <a class="reference internal" href="docstrings/pyrex.Signal.copy.html#pyrex.Signal.copy" title="pyrex.Signal.copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signal.copy()</span></code></a> method to make a duplicate object first so that further uses of the original signal object are unaffected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">signal_copy</span> <span class="o">=</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">signal_copy</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="mi">1001</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">signal_copy</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal_copy</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1001</span>
<span class="n">signal_copy</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span>
<span class="n">signal_copy</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal_copy</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">signal_copy</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_3.png" src="_images/signal_3.png" />
<p>The <a class="reference internal" href="docstrings/pyrex.Signal.with_times.html#pyrex.Signal.with_times" title="pyrex.Signal.with_times"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signal.with_times()</span></code></a> method will interpolate/extrapolate the signal’s values onto a new times array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">new_signal</span> <span class="o">=</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">with_times</span><span class="p">(</span><span class="n">new_times</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">new_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;new signal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;original signal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_4.png" src="_images/signal_4.png" />
<p>The <a class="reference internal" href="docstrings/pyrex.Signal.shift.html#pyrex.Signal.shift" title="pyrex.Signal.shift"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signal.shift()</span></code></a> method will shift the signal in time by a specified value (in seconds):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_signal</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_5.png" src="_images/signal_5.png" />
<p>The <a class="reference internal" href="docstrings/pyrex.Signal.filter_frequencies.html#pyrex.Signal.filter_frequencies" title="pyrex.Signal.filter_frequencies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signal.filter_frequencies()</span></code></a> method will apply a frequency-domain filter to the values array based on the frequency response function provided. In cases where the filter is designed for only positive frequencies (as below) the filtered frequency may exhibit strange behavior, including potentially having an imaginary part. To resolve that issue, pass <code class="docutils literal notranslate"><span class="pre">force_real=True</span></code> to the <a class="reference internal" href="docstrings/pyrex.Signal.filter_frequencies.html#pyrex.Signal.filter_frequencies" title="pyrex.Signal.filter_frequencies"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signal.filter_frequencies()</span></code></a> method, which will extrapolate the given filter to negative frequencies and ensure a real-valued filtered signal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lowpass_filter</span><span class="p">(</span><span class="n">frequency</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">frequency</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<span class="n">value_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">time_array</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">time_array</span><span class="p">)</span>
<span class="n">my_signal</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">time_array</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">value_array</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">)</span>
<span class="n">my_signal</span><span class="o">.</span><span class="n">filter_frequencies</span><span class="p">(</span><span class="n">lowpass_filter</span><span class="p">,</span> <span class="n">force_real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">my_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;filtered&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_6.png" src="_images/signal_6.png" />
<p>A number of classes which inherit from the <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> class are included in PyREx: <a class="reference internal" href="docstrings/pyrex.EmptySignal.html#pyrex.EmptySignal" title="pyrex.EmptySignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmptySignal</span></code></a>, <a class="reference internal" href="docstrings/pyrex.FunctionSignal.html#pyrex.FunctionSignal" title="pyrex.FunctionSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSignal</span></code></a>, <a class="reference internal" href="docstrings/pyrex.AskaryanSignal.html#pyrex.AskaryanSignal" title="pyrex.AskaryanSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">AskaryanSignal</span></code></a>, and <a class="reference internal" href="docstrings/pyrex.ThermalNoise.html#pyrex.ThermalNoise" title="pyrex.ThermalNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalNoise</span></code></a>.</p>
<p><a class="reference internal" href="docstrings/pyrex.EmptySignal.html#pyrex.EmptySignal" title="pyrex.EmptySignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">EmptySignal</span></code></a> is simply a signal whose values are all zero:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">empty</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">EmptySignal</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">time_array</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">empty</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">empty</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_7.png" src="_images/signal_7.png" />
<p><a class="reference internal" href="docstrings/pyrex.FunctionSignal.html#pyrex.FunctionSignal" title="pyrex.FunctionSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSignal</span></code></a> takes a function of time and creates a signal based on that function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">square_wave</span><span class="p">(</span><span class="n">time</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">square_signal</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">FunctionSignal</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">time_array</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">square_wave</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">square_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">square_signal</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_8.png" src="_images/signal_8.png" />
<p>Additionally, <a class="reference internal" href="docstrings/pyrex.FunctionSignal.html#pyrex.FunctionSignal" title="pyrex.FunctionSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSignal</span></code></a> leverages its knowledge of the function to more accurately interpolate and extrapolate values for the <a class="reference internal" href="docstrings/pyrex.Signal.with_times.html#pyrex.Signal.with_times" title="pyrex.Signal.with_times"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Signal.with_times()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">new_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">201</span><span class="p">)</span>
<span class="n">long_square_signal</span> <span class="o">=</span> <span class="n">square_signal</span><span class="o">.</span><span class="n">with_times</span><span class="p">(</span><span class="n">new_times</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">long_square_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">long_square_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;extrapolated&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">square_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">square_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;original&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_9.png" src="_images/signal_9.png" />
<p><a class="reference internal" href="docstrings/pyrex.AskaryanSignal.html#pyrex.AskaryanSignal" title="pyrex.AskaryanSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">AskaryanSignal</span></code></a> produces an Askaryan pulse (in V/m) on a time array resulting from a given neutrino observed at a given angle from the shower axis and at a given distance from the shower vertex. For more about using the <a class="reference internal" href="docstrings/pyrex.Particle.html#pyrex.Particle" title="pyrex.Particle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a> class, see <a class="reference internal" href="#particle-generation"><span class="std std-ref">Particle Generation</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">40e-9</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<span class="n">neutrino_energy</span> <span class="o">=</span> <span class="mf">1e8</span> <span class="c1"># GeV</span>
<span class="n">neutrino</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Particle</span><span class="p">(</span><span class="s2">&quot;nu_e&quot;</span><span class="p">,</span> <span class="n">vertex</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">),</span> <span class="n">direction</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                          <span class="n">energy</span><span class="o">=</span><span class="n">neutrino_energy</span><span class="p">)</span>
<span class="n">neutrino</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">em_frac</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">neutrino</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">had_frac</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">observation_angle</span> <span class="o">=</span> <span class="mi">65</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span> <span class="c1"># radians</span>
<span class="n">observation_distance</span> <span class="o">=</span> <span class="mi">2000</span> <span class="c1"># meters</span>
<span class="n">askaryan</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">AskaryanSignal</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">time_array</span><span class="p">,</span> <span class="n">particle</span><span class="o">=</span><span class="n">neutrino</span><span class="p">,</span>
                                <span class="n">viewing_angle</span><span class="o">=</span><span class="n">observation_angle</span><span class="p">,</span>
                                <span class="n">viewing_distance</span><span class="o">=</span><span class="n">observation_distance</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">askaryan</span><span class="o">.</span><span class="n">value_type</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">askaryan</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">askaryan</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_10.png" src="_images/signal_10.png" />
<p><a class="reference internal" href="docstrings/pyrex.ThermalNoise.html#pyrex.ThermalNoise" title="pyrex.ThermalNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalNoise</span></code></a> produces Rayleigh-distributed noise (in V) at a given temperature and resistance, within a given frequency range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">40e-9</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<span class="n">noise_temp</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># K</span>
<span class="n">system_resistance</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># ohm</span>
<span class="n">frequency_range</span> <span class="o">=</span> <span class="p">(</span><span class="mf">550e6</span><span class="p">,</span> <span class="mf">750e6</span><span class="p">)</span> <span class="c1"># Hz</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">ThermalNoise</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">time_array</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">noise_temp</span><span class="p">,</span>
                           <span class="n">resistance</span><span class="o">=</span><span class="n">system_resistance</span><span class="p">,</span>
                           <span class="n">f_band</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">value_type</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">noise</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_11.png" src="_images/signal_11.png" />
<p>Note that since <a class="reference internal" href="docstrings/pyrex.ThermalNoise.html#pyrex.ThermalNoise" title="pyrex.ThermalNoise"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThermalNoise</span></code></a> inherits from <a class="reference internal" href="docstrings/pyrex.FunctionSignal.html#pyrex.FunctionSignal" title="pyrex.FunctionSignal"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionSignal</span></code></a>, it can be extrapolated nicely to new times. It may be highly periodic outside of its original time range however, but this can be tuned using the <code class="xref py py-attr docutils literal notranslate"><span class="pre">uniqueness_factor</span></code> parameter.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">short_noise</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">ThermalNoise</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">time_array</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">noise_temp</span><span class="p">,</span>
                                 <span class="n">resistance</span><span class="o">=</span><span class="n">system_resistance</span><span class="p">,</span>
                                 <span class="n">f_band</span><span class="o">=</span><span class="p">(</span><span class="mf">100e6</span><span class="p">,</span> <span class="mf">400e6</span><span class="p">))</span>
<span class="n">long_noise</span> <span class="o">=</span> <span class="n">short_noise</span><span class="o">.</span><span class="n">with_times</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10e-9</span><span class="p">,</span> <span class="mf">90e-9</span><span class="p">,</span> <span class="mi">2001</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">short_noise</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">short_noise</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">long_noise</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">long_noise</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">40e-9</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/signal_12.png" src="_images/signal_12.png" />
<img alt="_images/signal_13.png" src="_images/signal_13.png" />
</div>
<div class="section" id="antenna-class-and-subclasses">
<h2>Antenna Class and Subclasses<a class="headerlink" href="#antenna-class-and-subclasses" title="Permalink to this headline">¶</a></h2>
<p>The base <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class provided by PyREx is designed to be subclassed in order to match various antenna models. At its core, an <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> object is initialized with a position and a number of optional parameters, including a temperature, resistance, and frequency range (for noise calculations) and a boolean dictating whether or not noise should be added to the antenna’s signals.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Please note that some values are unrealistic for demonstration purposes</span>
<span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># m</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># K</span>
<span class="n">resistance</span> <span class="o">=</span> <span class="mf">1e17</span> <span class="c1"># ohm</span>
<span class="n">frequency_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># Hz</span>
<span class="n">basic_antenna</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Antenna</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                              <span class="n">resistance</span><span class="o">=</span><span class="n">resistance</span><span class="p">,</span>
                              <span class="n">freq_range</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">)</span>
<span class="n">noiseless_antenna</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Antenna</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">noisy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The basic useful properties of an <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> object are <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_hit</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">waveforms</span></code>. The <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_hit</span></code> property specifies whether or not the antenna has been triggered by an event. <code class="xref py py-attr docutils literal notranslate"><span class="pre">waveforms</span></code> is a list of all the waveforms which have triggered the antenna. The antenna also defines a <a class="reference internal" href="api/signals.html#module-pyrex.signals" title="pyrex.signals"><code class="xref py py-attr docutils literal notranslate"><span class="pre">signals</span></code></a> attribute, which is a list of all signals the antenna has received (without noise), and <code class="xref py py-attr docutils literal notranslate"><span class="pre">all_waveforms</span></code> which is a list of all waveforms (signal plus noise) the antenna has received including those which didn’t trigger. Finally, the antenna has an <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_hit_mc</span></code> property which is similar to <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_hit</span></code>, but does not count triggers where noise alone would have triggered the antenna.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">basic_antenna</span><span class="o">.</span><span class="n">is_hit</span> <span class="o">==</span> <span class="kc">False</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">waveforms</span> <span class="o">==</span> <span class="p">[]</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class contains two attributes and three methods which represent characteristics of the antenna as they relate to signal processing. The attributes are <code class="xref py py-attr docutils literal notranslate"><span class="pre">efficiency</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">antenna_factor</span></code>, and the methods are <a class="reference internal" href="docstrings/pyrex.Antenna.frequency_response.html#pyrex.Antenna.frequency_response" title="pyrex.Antenna.frequency_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.frequency_response()</span></code></a>, <a class="reference internal" href="docstrings/pyrex.Antenna.directional_gain.html#pyrex.Antenna.directional_gain" title="pyrex.Antenna.directional_gain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.directional_gain()</span></code></a>, and <a class="reference internal" href="docstrings/pyrex.Antenna.polarization_gain.html#pyrex.Antenna.polarization_gain" title="pyrex.Antenna.polarization_gain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.polarization_gain()</span></code></a>. The attributes are to be set and the methods overwritten in order to customize the way the antenna responds to incoming signals. <code class="xref py py-attr docutils literal notranslate"><span class="pre">efficiency</span></code> is simply a scalar which multiplies the signal the antenna receives (default value is <code class="docutils literal notranslate"><span class="pre">1</span></code>). <code class="xref py py-attr docutils literal notranslate"><span class="pre">antenna_factor</span></code> is a factor used in converting received electric fields into voltages (<code class="xref py py-attr docutils literal notranslate"><span class="pre">antenna_factor</span></code> = E / V; default value is <code class="docutils literal notranslate"><span class="pre">1</span></code>). <a class="reference internal" href="docstrings/pyrex.Antenna.frequency_response.html#pyrex.Antenna.frequency_response" title="pyrex.Antenna.frequency_response"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.frequency_response()</span></code></a> takes a frequency or list of frequencies (in Hz) and returns the frequency response of the antenna at each frequency given (default always returns <code class="docutils literal notranslate"><span class="pre">1</span></code>). <a class="reference internal" href="docstrings/pyrex.Antenna.directional_gain.html#pyrex.Antenna.directional_gain" title="pyrex.Antenna.directional_gain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.directional_gain()</span></code></a> takes angles theta and phi in the antenna’s coordinates and returns the antenna’s gain for a signal coming from that direction (default always returns <code class="docutils literal notranslate"><span class="pre">1</span></code>). <a class="reference internal" href="docstrings/pyrex.Antenna.directional_gain.html#pyrex.Antenna.directional_gain" title="pyrex.Antenna.directional_gain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.directional_gain()</span></code></a> is dependent on the antenna’s orientation, which is defined by its <code class="xref py py-attr docutils literal notranslate"><span class="pre">z_axis</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">x_axis</span></code> attributes. To change the antenna’s orientation, use the <a class="reference internal" href="docstrings/pyrex.Antenna.set_orientation.html#pyrex.Antenna.set_orientation" title="pyrex.Antenna.set_orientation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.set_orientation()</span></code></a> method which takes <code class="docutils literal notranslate"><span class="pre">z_axis</span></code> and <code class="docutils literal notranslate"><span class="pre">x_axis</span></code> arguments. Finally, <a class="reference internal" href="docstrings/pyrex.Antenna.polarization_gain.html#pyrex.Antenna.polarization_gain" title="pyrex.Antenna.polarization_gain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.polarization_gain()</span></code></a> takes a polarization vector and returns the antenna’s gain for a signal with that polarization (default always returns <code class="docutils literal notranslate"><span class="pre">1</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">basic_antenna</span><span class="o">.</span><span class="n">efficiency</span> <span class="o">==</span> <span class="mi">1</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">antenna_factor</span> <span class="o">==</span> <span class="mi">1</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">frequency_response</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span> <span class="o">==</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">directional_gain</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">polarization_gain</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class defines an <a class="reference internal" href="docstrings/pyrex.Antenna.trigger.html#pyrex.Antenna.trigger" title="pyrex.Antenna.trigger"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.trigger()</span></code></a> method which is also expected to be overwritten. <a class="reference internal" href="docstrings/pyrex.Antenna.trigger.html#pyrex.Antenna.trigger" title="pyrex.Antenna.trigger"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.trigger()</span></code></a> takes a <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> object as an argument and returns a boolean of whether or not the antenna would trigger on that signal (default always returns <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">basic_antenna</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="kc">True</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class also defines an <a class="reference internal" href="docstrings/pyrex.Antenna.receive.html#pyrex.Antenna.receive" title="pyrex.Antenna.receive"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.receive()</span></code></a> method which takes a <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> object and processes the signal according to the antenna’s attributes (<code class="xref py py-attr docutils literal notranslate"><span class="pre">efficiency</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">antenna_factor</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">response</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">directional_gain</span></code>, and <code class="xref py py-attr docutils literal notranslate"><span class="pre">polarization_gain</span></code> as described above). To use the <a class="reference internal" href="docstrings/pyrex.Antenna.receive.html#pyrex.Antenna.receive" title="pyrex.Antenna.receive"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.receive()</span></code></a> method, simply pass it the <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> object the antenna sees, and the <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class will handle the rest. You can also optionally specify the direction of travel of the signal (used in the <a class="reference internal" href="docstrings/pyrex.Antenna.directional_gain.html#pyrex.Antenna.directional_gain" title="pyrex.Antenna.directional_gain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.directional_gain()</span></code></a> calculation) and the polarization direction of the signal (used in the <a class="reference internal" href="docstrings/pyrex.Antenna.polarization_gain.html#pyrex.Antenna.polarization_gain" title="pyrex.Antenna.polarization_gain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.polarization_gain()</span></code></a> calculation). If either of these is unspecified, the corresponding gain will simply be set to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">limited_sin</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">min_time</span><span class="p">,</span> <span class="n">max_time</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">))</span>
    <span class="n">in_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">times</span><span class="o">&gt;=</span><span class="n">min_time</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">times</span><span class="o">&lt;</span><span class="n">max_time</span><span class="p">)</span>
    <span class="n">values</span><span class="p">[</span><span class="n">in_range</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">in_range</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">values</span>

<span class="n">incoming_signal_1</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">FunctionSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">limited_sin</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                                        <span class="n">value_type</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">voltage</span><span class="p">)</span>
<span class="n">incoming_signal_2</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">FunctionSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">limited_sin</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                                        <span class="n">value_type</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">voltage</span><span class="p">)</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">incoming_signal_1</span><span class="p">)</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">incoming_signal_2</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">polarization</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">is_hit</span> <span class="o">==</span> <span class="kc">True</span>
<span class="k">for</span> <span class="n">waveform</span><span class="p">,</span> <span class="n">pure_signal</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">basic_antenna</span><span class="o">.</span><span class="n">waveforms</span><span class="p">,</span> <span class="n">basic_antenna</span><span class="o">.</span><span class="n">signals</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">waveform</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Waveform&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pure_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">pure_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pure Signal&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/antenna_1.png" src="_images/antenna_1.png" />
<img alt="_images/antenna_2.png" src="_images/antenna_2.png" />
<p>Beyond <a class="reference internal" href="docstrings/pyrex.Antenna.waveforms.html#pyrex.Antenna.waveforms" title="pyrex.Antenna.waveforms"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Antenna.waveforms</span></code></a>, the <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> object also provides methods for checking the waveform and trigger status for arbitrary times: <a class="reference internal" href="docstrings/pyrex.Antenna.full_waveform.html#pyrex.Antenna.full_waveform" title="pyrex.Antenna.full_waveform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.full_waveform()</span></code></a> and <a class="reference internal" href="docstrings/pyrex.Antenna.is_hit_during.html#pyrex.Antenna.is_hit_during" title="pyrex.Antenna.is_hit_during"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.is_hit_during()</span></code></a>. Both of these methods take a time array as an argument and return either the waveform <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> object for those times or whether said waveform triggered the antenna, respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">total_waveform</span> <span class="o">=</span> <span class="n">basic_antenna</span><span class="o">.</span><span class="n">full_waveform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">total_waveform</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">total_waveform</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Total Waveform&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">incoming_signal_1</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">incoming_signal_1</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pure Signals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">incoming_signal_2</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">incoming_signal_2</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">basic_antenna</span><span class="o">.</span><span class="n">is_hit_during</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="o">==</span> <span class="kc">True</span>
</pre></div>
</div>
<img alt="_images/antenna_3.png" src="_images/antenna_3.png" />
<p>Finally, the <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class defines an <a class="reference internal" href="docstrings/pyrex.Antenna.clear.html#pyrex.Antenna.clear" title="pyrex.Antenna.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.clear()</span></code></a> method which will reset the antenna to a state of having received no signals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">basic_antenna</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">is_hit</span> <span class="o">==</span> <span class="kc">False</span>
<span class="nb">len</span><span class="p">(</span><span class="n">basic_antenna</span><span class="o">.</span><span class="n">waveforms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="docstrings/pyrex.Antenna.clear.html#pyrex.Antenna.clear" title="pyrex.Antenna.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Antenna.clear()</span></code></a> method can also optionally reset the source of noise waveforms by passing <code class="docutils literal notranslate"><span class="pre">reset_noise=True</span></code> so that if the same signals are given after the antenna is cleared, the noise waveforms will be different:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">noise_before</span> <span class="o">=</span> <span class="n">basic_antenna</span><span class="o">.</span><span class="n">make_noise</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise_before</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">noise_before</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Noise Before Clear&quot;</span><span class="p">)</span>
<span class="n">basic_antenna</span><span class="o">.</span><span class="n">clear</span><span class="p">(</span><span class="n">reset_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">noise_after</span> <span class="o">=</span> <span class="n">basic_antenna</span><span class="o">.</span><span class="n">make_noise</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">noise_after</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">noise_after</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Noise After Clear&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/antenna_4.png" src="_images/antenna_4.png" />
<p>To create a custom antenna, simply inherit from the <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NoiselessThresholdAntenna</span><span class="p">(</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Antenna</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">noisy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>

    <span class="k">def</span> <span class="nf">trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Our custom <code class="xref py py-class docutils literal notranslate"><span class="pre">NoiselessThresholdAntenna</span></code> should only trigger when the amplitude of a signal exceeds its threshold value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_antenna</span> <span class="o">=</span> <span class="n">NoiselessThresholdAntenna</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">incoming_signal</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">FunctionSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">,</span>
                                       <span class="n">value_type</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">voltage</span><span class="p">)</span>
<span class="n">my_antenna</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">incoming_signal</span><span class="p">)</span>
<span class="n">my_antenna</span><span class="o">.</span><span class="n">is_hit</span> <span class="o">==</span> <span class="kc">False</span>
<span class="nb">len</span><span class="p">(</span><span class="n">my_antenna</span><span class="o">.</span><span class="n">waveforms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="nb">len</span><span class="p">(</span><span class="n">my_antenna</span><span class="o">.</span><span class="n">all_waveforms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

<span class="n">incoming_signal</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">incoming_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span>
                               <span class="mi">5</span><span class="o">*</span><span class="n">incoming_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                               <span class="n">incoming_signal</span><span class="o">.</span><span class="n">value_type</span><span class="p">)</span>
<span class="n">my_antenna</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">incoming_signal</span><span class="p">)</span>
<span class="n">my_antenna</span><span class="o">.</span><span class="n">is_hit</span> <span class="o">==</span> <span class="kc">True</span>
<span class="nb">len</span><span class="p">(</span><span class="n">my_antenna</span><span class="o">.</span><span class="n">waveforms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="nb">len</span><span class="p">(</span><span class="n">my_antenna</span><span class="o">.</span><span class="n">all_waveforms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

<span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">my_antenna</span><span class="o">.</span><span class="n">waveforms</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/antenna_5.png" src="_images/antenna_5.png" />
<p>For more on customizing PyREx, see the <a class="reference internal" href="customize.html#custom-package"><span class="std std-ref">Custom Sub-Package</span></a> section.</p>
<p>PyREx also defines <a class="reference internal" href="docstrings/pyrex.DipoleAntenna.html#pyrex.DipoleAntenna" title="pyrex.DipoleAntenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">DipoleAntenna</span></code></a>, a subclass of <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> which provides a basic threshold trigger, a basic bandpass filter frequency response, a sine-function directional gain, and a typical dot-product polarization effect. A <a class="reference internal" href="docstrings/pyrex.DipoleAntenna.html#pyrex.DipoleAntenna" title="pyrex.DipoleAntenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">DipoleAntenna</span></code></a> object can be created as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">antenna_identifier</span> <span class="o">=</span> <span class="s2">&quot;antenna 1&quot;</span>
<span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="n">center_frequency</span> <span class="o">=</span> <span class="mf">250e6</span> <span class="c1"># Hz</span>
<span class="n">bandwidth</span> <span class="o">=</span> <span class="mf">300e6</span> <span class="c1"># Hz</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># K</span>
<span class="n">resistance</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># ohm</span>
<span class="n">antenna_length</span> <span class="o">=</span> <span class="mf">3e8</span><span class="o">/</span><span class="n">center_frequency</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># m</span>
<span class="n">polarization_direction</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">trigger_threshold</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="c1"># V</span>
<span class="n">dipole</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">DipoleAntenna</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">antenna_identifier</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
                             <span class="n">center_frequency</span><span class="o">=</span><span class="n">center_frequency</span><span class="p">,</span>
                             <span class="n">bandwidth</span><span class="o">=</span><span class="n">bandwidth</span><span class="p">,</span>
                             <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">resistance</span><span class="o">=</span><span class="n">resistance</span><span class="p">,</span>
                             <span class="n">effective_height</span><span class="o">=</span><span class="n">antenna_length</span><span class="p">,</span>
                             <span class="n">orientation</span><span class="o">=</span><span class="n">polarization_direction</span><span class="p">,</span>
                             <span class="n">trigger_threshold</span><span class="o">=</span><span class="n">trigger_threshold</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="antennasystem-and-detector-classes">
<h2>AntennaSystem and Detector Classes<a class="headerlink" href="#antennasystem-and-detector-classes" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="docstrings/pyrex.AntennaSystem.html#pyrex.AntennaSystem" title="pyrex.AntennaSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">AntennaSystem</span></code></a> class is designed to bridge the gap between the basic antenna classes and realistic antenna systems that include front-end processing of the antenna’s signals. It is designed to be subclassed, but by default it takes as an argument the <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class or subclass it is extending, or an object of that class. It provides an interface nearly identical to that of the <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class, but where an <a class="reference internal" href="docstrings/pyrex.AntennaSystem.front_end.html#pyrex.AntennaSystem.front_end" title="pyrex.AntennaSystem.front_end"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AntennaSystem.front_end()</span></code></a> method (which by default does nothing) is applied to the extended antenna’s signals.</p>
<p>To extend an <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> class or subclass into a full antenna system, inherit from the <a class="reference internal" href="docstrings/pyrex.AntennaSystem.html#pyrex.AntennaSystem" title="pyrex.AntennaSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">AntennaSystem</span></code></a> class and define the <a class="reference internal" href="docstrings/pyrex.AntennaSystem.front_end.html#pyrex.AntennaSystem.front_end" title="pyrex.AntennaSystem.front_end"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AntennaSystem.front_end()</span></code></a> method. If the front end of the antenna system requires some time to equilibrate to noise signals, that can be specified in the <a class="reference internal" href="docstrings/pyrex.AntennaSystem.lead_in_time.html#pyrex.AntennaSystem.lead_in_time" title="pyrex.AntennaSystem.lead_in_time"><code class="xref py py-attr docutils literal notranslate"><span class="pre">AntennaSystem.lead_in_time</span></code></a> attribute, adding that amount of time before any waveforms to be processed. A different trigger also optionally can be defined for the antenna system (by default it uses the antenna’s trigger):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PowerAntennaSystem</span><span class="p">(</span><span class="n">pyrex</span><span class="o">.</span><span class="n">AntennaSystem</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Antenna system whose signals and waveforms are powers instead of</span>
<span class="sd">    voltages.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">resistance</span><span class="p">,</span> <span class="n">frequency_range</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Antenna</span><span class="p">)</span>
        <span class="c1"># The setup_antenna method simply passes all arguments on to the</span>
        <span class="c1"># antenna class passed to super.__init__() and stores the resulting</span>
        <span class="c1"># antenna to self.antenna</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setup_antenna</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                           <span class="n">resistance</span><span class="o">=</span><span class="n">resistance</span><span class="p">,</span>
                           <span class="n">freq_range</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">front_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">values</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
                            <span class="n">value_type</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">power</span><span class="p">)</span>
</pre></div>
</div>
<p>Objects of this class can then, for the most part, be interacted with as though they were regular antenna objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># m</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># K</span>
<span class="n">resistance</span> <span class="o">=</span> <span class="mf">1e17</span> <span class="c1"># ohm</span>
<span class="n">frequency_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># Hz</span>

<span class="n">basic_antenna_system</span> <span class="o">=</span> <span class="n">PowerAntennaSystem</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
                                          <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                                          <span class="n">resistance</span><span class="o">=</span><span class="n">resistance</span><span class="p">,</span>
                                          <span class="n">frequency_range</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">)</span>

<span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]))</span> <span class="o">==</span> <span class="kc">True</span>

<span class="k">def</span> <span class="nf">limited_sin</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">min_time</span><span class="p">,</span> <span class="n">max_time</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">))</span>
    <span class="n">in_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">times</span><span class="o">&gt;=</span><span class="n">min_time</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">times</span><span class="o">&lt;</span><span class="n">max_time</span><span class="p">)</span>
    <span class="n">values</span><span class="p">[</span><span class="n">in_range</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">in_range</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">values</span>

<span class="n">incoming_signal_1</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">FunctionSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">limited_sin</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                                         <span class="n">value_type</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">voltage</span><span class="p">)</span>
<span class="n">incoming_signal_2</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">FunctionSignal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">limited_sin</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
                                         <span class="n">value_type</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">voltage</span><span class="p">)</span>
<span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">incoming_signal_1</span><span class="p">)</span>
<span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">incoming_signal_2</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                             <span class="n">polarization</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">is_hit</span> <span class="o">==</span> <span class="kc">True</span>
<span class="k">for</span> <span class="n">waveform</span><span class="p">,</span> <span class="n">pure_signal</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">waveforms</span><span class="p">,</span>
                                 <span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">signals</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">waveform</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">waveform</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Waveform&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pure_signal</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">pure_signal</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pure Signal&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">total_waveform</span> <span class="o">=</span> <span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">full_waveform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">total_waveform</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">total_waveform</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Total Waveform&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">incoming_signal_1</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">incoming_signal_1</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pure Signals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">incoming_signal_2</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">incoming_signal_2</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">is_hit_during</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="o">==</span> <span class="kc">True</span>

<span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">is_hit</span> <span class="o">==</span> <span class="kc">False</span>
<span class="nb">len</span><span class="p">(</span><span class="n">basic_antenna_system</span><span class="o">.</span><span class="n">waveforms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<img alt="_images/detector_1.png" src="_images/detector_1.png" />
<img alt="_images/detector_2.png" src="_images/detector_2.png" />
<img alt="_images/detector_3.png" src="_images/detector_3.png" />
<p>The <a class="reference internal" href="docstrings/pyrex.Detector.html#pyrex.Detector" title="pyrex.Detector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Detector</span></code></a> class is another convenience class meant to be subclassed. It is useful for automatically generating many antennas (as would be used in a detector). Subclasses must define a <a class="reference internal" href="docstrings/pyrex.Detector.set_positions.html#pyrex.Detector.set_positions" title="pyrex.Detector.set_positions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Detector.set_positions()</span></code></a> method to assign vector positions to the <code class="xref py py-attr docutils literal notranslate"><span class="pre">antenna_positions</span></code> attribute. By default <a class="reference internal" href="docstrings/pyrex.Detector.set_positions.html#pyrex.Detector.set_positions" title="pyrex.Detector.set_positions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Detector.set_positions()</span></code></a> will raise a <code class="xref py py-exc docutils literal notranslate"><span class="pre">NotImplementedError</span></code>. Additionally subclasses may extend the default <a class="reference internal" href="docstrings/pyrex.Detector.build_antennas.html#pyrex.Detector.build_antennas" title="pyrex.Detector.build_antennas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Detector.build_antennas()</span></code></a> method which by default simply builds antennas of a passed antenna class using any keyword arguments passed to the method. In addition to simply generating many antennas at desired positions, another convenience of the <a class="reference internal" href="docstrings/pyrex.Detector.html#pyrex.Detector" title="pyrex.Detector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Detector</span></code></a> class is that once the <a class="reference internal" href="docstrings/pyrex.Detector.build_antennas.html#pyrex.Detector.build_antennas" title="pyrex.Detector.build_antennas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Detector.build_antennas()</span></code></a> method is run, it can be iterated directly as though the object were a list of the antennas it generated. And finally, the <a class="reference internal" href="docstrings/pyrex.Detector.triggered.html#pyrex.Detector.triggered" title="pyrex.Detector.triggered"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Detector.triggered()</span></code></a> method will check whether any of the antennas have been triggered, and can be overridden in subclasses to define a more complicated detector trigger. An example of subclassing the <a class="reference internal" href="docstrings/pyrex.Detector.html#pyrex.Detector" title="pyrex.Detector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Detector</span></code></a> class is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AntennaGrid</span><span class="p">(</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Detector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A detector composed of a plane of antennas in a rectangular grid layout</span>
<span class="sd">    some distance below the ice.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">set_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">separation</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">depth</span><span class="o">=-</span><span class="mi">50</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antenna_positions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">n_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">number</span><span class="p">))</span>
        <span class="n">n_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">number</span><span class="o">/</span><span class="n">n_x</span><span class="p">)</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">separation</span>
        <span class="n">dy</span> <span class="o">=</span> <span class="n">separation</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_x</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">dx</span><span class="o">*</span><span class="n">n_x</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dx</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dx</span><span class="o">*</span><span class="n">i</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_y</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">dy</span><span class="o">*</span><span class="n">n_y</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dy</span><span class="o">*</span><span class="n">j</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">antenna_positions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">depth</span><span class="p">))</span>

<span class="n">grid_detector</span> <span class="o">=</span> <span class="n">AntennaGrid</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>

<span class="c1"># Build the antennas</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># K</span>
<span class="n">resistance</span> <span class="o">=</span> <span class="mf">1e17</span> <span class="c1"># ohm</span>
<span class="n">frequency_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># Hz</span>
<span class="n">grid_detector</span><span class="o">.</span><span class="n">build_antennas</span><span class="p">(</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Antenna</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                             <span class="n">resistance</span><span class="o">=</span><span class="n">resistance</span><span class="p">,</span>
                             <span class="n">freq_range</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">antenna</span> <span class="ow">in</span> <span class="n">grid_detector</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">antenna</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">antenna</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;kD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/detector_4.png" src="_images/detector_4.png" />
<p>Due to the parallels between <a class="reference internal" href="docstrings/pyrex.Antenna.html#pyrex.Antenna" title="pyrex.Antenna"><code class="xref py py-class docutils literal notranslate"><span class="pre">Antenna</span></code></a> and <a class="reference internal" href="docstrings/pyrex.AntennaSystem.html#pyrex.AntennaSystem" title="pyrex.AntennaSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">AntennaSystem</span></code></a>, an antenna system may also be used in the custom detector class. Note however, that the antenna positions must be accessed as <code class="xref py py-attr docutils literal notranslate"><span class="pre">antenna.antenna.position</span></code> since we didn’t define a position attribute for the <code class="xref py py-class docutils literal notranslate"><span class="pre">PowerAntennaSystem</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid_detector</span> <span class="o">=</span> <span class="n">AntennaGrid</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Build the antennas</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># K</span>
<span class="n">resistance</span> <span class="o">=</span> <span class="mf">1e17</span> <span class="c1"># ohm</span>
<span class="n">frequency_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># Hz</span>
<span class="n">grid_detector</span><span class="o">.</span><span class="n">build_antennas</span><span class="p">(</span><span class="n">PowerAntennaSystem</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
                            <span class="n">resistance</span><span class="o">=</span><span class="n">resistance</span><span class="p">,</span>
                            <span class="n">frequency_range</span><span class="o">=</span><span class="n">frequency_range</span><span class="p">)</span>

<span class="k">for</span> <span class="n">antenna</span> <span class="ow">in</span> <span class="n">grid_detector</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">antenna</span><span class="o">.</span><span class="n">antenna</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">antenna</span><span class="o">.</span><span class="n">antenna</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s2">&quot;kD&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/detector_5.png" src="_images/detector_5.png" />
<p>For convenience, objects derived from the <a class="reference internal" href="docstrings/pyrex.Detector.html#pyrex.Detector" title="pyrex.Detector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Detector</span></code></a> class can be added into a <code class="xref py py-class docutils literal notranslate"><span class="pre">CombinedDetector</span></code> object, which behaves similarly. The <code class="xref py py-meth docutils literal notranslate"><span class="pre">CombinedDetector.build_antennas()</span></code> method should work seamlessly if the sub-detectors have the same <code class="xref py py-func docutils literal notranslate"><span class="pre">build_antennas()</span></code> method, otherwise it will do its best to dispatch keyword arguments between the sub-detectors. Similarly the <code class="xref py py-meth docutils literal notranslate"><span class="pre">CombinedDetector.triggered()</span></code> method will return <code class="docutils literal notranslate"><span class="pre">True</span></code> if either sub-detector was triggered, with arguments to the method dispatched to the proper sub-triggers.</p>
</div>
<div class="section" id="ice-and-earth-models">
<h2>Ice and Earth Models<a class="headerlink" href="#ice-and-earth-models" title="Permalink to this headline">¶</a></h2>
<p>PyREx provides an ice model object <a class="reference internal" href="docstrings/pyrex.ice.html#pyrex.ice" title="pyrex.ice"><code class="xref py py-data docutils literal notranslate"><span class="pre">ice</span></code></a>, which is an instance of whichever ice model class is preferred (currently <a class="reference internal" href="docstrings/pyrex.ice_model.AntarcticIce.html#pyrex.ice_model.AntarcticIce" title="pyrex.ice_model.AntarcticIce"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrex.ice_model.AntarcticIce</span></code></a>). The <a class="reference internal" href="docstrings/pyrex.ice.html#pyrex.ice" title="pyrex.ice"><code class="xref py py-data docutils literal notranslate"><span class="pre">ice</span></code></a> object provides a number of (hopefully self-explanatory) methods for calculating characteristics of the ice at different depths and frequencies as below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">depth</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span> <span class="c1"># m</span>
<span class="n">pyrex</span><span class="o">.</span><span class="n">ice</span><span class="o">.</span><span class="n">temperature</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
<span class="n">pyrex</span><span class="o">.</span><span class="n">ice</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
<span class="n">pyrex</span><span class="o">.</span><span class="n">ice</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="mf">1e8</span> <span class="c1"># Hz</span>
<span class="n">pyrex</span><span class="o">.</span><span class="n">ice</span><span class="o">.</span><span class="n">attenuation_length</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">frequency</span><span class="p">)</span>
</pre></div>
</div>
<p>PyREx also provides an Earth model object <a class="reference internal" href="docstrings/pyrex.earth.html#pyrex.earth" title="pyrex.earth"><code class="xref py py-data docutils literal notranslate"><span class="pre">earth</span></code></a>, which is similarly an instance of whichever Earth model class is preferred (currently <a class="reference internal" href="docstrings/pyrex.earth_model.PREM.html#pyrex.earth_model.PREM" title="pyrex.earth_model.PREM"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrex.earth_model.PREM</span></code></a>). This model provides two methods: <code class="xref py py-func docutils literal notranslate"><span class="pre">density()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">slant_depth()</span></code>. <code class="xref py py-func docutils literal notranslate"><span class="pre">density()</span></code> calculates the density in grams per cubic centimeter of the Earth at a given radius, and <code class="xref py py-func docutils literal notranslate"><span class="pre">slant_depth()</span></code> calculates the material thickness in grams per square centimeter of a chord cutting through the Earth in a given direction, starting from a given point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">radius</span> <span class="o">=</span> <span class="mi">6360000</span> <span class="c1"># m</span>
<span class="n">pyrex</span><span class="o">.</span><span class="n">earth</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
<span class="n">angle</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span> <span class="c1"># radians</span>
<span class="n">direction</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
<span class="n">endpoint</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">)</span> <span class="c1"># m</span>
<span class="n">pyrex</span><span class="o">.</span><span class="n">earth</span><span class="o">.</span><span class="n">slant_depth</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ray-tracing">
<h2>Ray Tracing<a class="headerlink" href="#ray-tracing" title="Permalink to this headline">¶</a></h2>
<p>PyREx provides ray tracing in the <a class="reference internal" href="docstrings/pyrex.RayTracer.html#pyrex.RayTracer" title="pyrex.RayTracer"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracer</span></code></a> and <a class="reference internal" href="docstrings/pyrex.RayTracePath.html#pyrex.RayTracePath" title="pyrex.RayTracePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracePath</span></code></a> classes. <a class="reference internal" href="docstrings/pyrex.RayTracer.html#pyrex.RayTracer" title="pyrex.RayTracer"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracer</span></code></a> takes a launch point and receiving point as arguments (and optionally an ice model and z-step), and will solve for the paths between the points (as <a class="reference internal" href="docstrings/pyrex.RayTracePath.html#pyrex.RayTracePath" title="pyrex.RayTracePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracePath</span></code></a> objects).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">)</span> <span class="c1"># m</span>
<span class="n">finish</span> <span class="o">=</span> <span class="p">(</span><span class="mi">750</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># m</span>
<span class="n">my_ray_tracer</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">RayTracer</span><span class="p">(</span><span class="n">from_point</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">to_point</span><span class="o">=</span><span class="n">finish</span><span class="p">)</span>
</pre></div>
</div>
<p>The two most useful properties of <a class="reference internal" href="docstrings/pyrex.RayTracer.html#pyrex.RayTracer" title="pyrex.RayTracer"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracer</span></code></a> are <code class="xref py py-attr docutils literal notranslate"><span class="pre">exists</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">solutions</span></code>. The <code class="xref py py-attr docutils literal notranslate"><span class="pre">exists</span></code> property is a boolean value of whether or not path solutions exist between the launch and receiving points. <code class="xref py py-attr docutils literal notranslate"><span class="pre">solutions</span></code> is the list of (zero or two) <a class="reference internal" href="docstrings/pyrex.RayTracePath.html#pyrex.RayTracePath" title="pyrex.RayTracePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracePath</span></code></a> objects which exist between the launch and receiving points. There are many other properties available in <a class="reference internal" href="docstrings/pyrex.RayTracer.html#pyrex.RayTracer" title="pyrex.RayTracer"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracer</span></code></a>, outlined in the <a class="reference internal" href="api.html#pyrex-api"><span class="std std-ref">PyREx API</span></a> section, which are mostly used internally and maybe not interesting otherwise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_ray_tracer</span><span class="o">.</span><span class="n">exists</span>
<span class="n">my_ray_tracer</span><span class="o">.</span><span class="n">solutions</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="docstrings/pyrex.RayTracePath.html#pyrex.RayTracePath" title="pyrex.RayTracePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracePath</span></code></a> class contains the attributes of the paths between points. The most useful properties of <a class="reference internal" href="docstrings/pyrex.RayTracePath.html#pyrex.RayTracePath" title="pyrex.RayTracePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracePath</span></code></a> are <code class="xref py py-attr docutils literal notranslate"><span class="pre">tof</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">path_length</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">emitted_direction</span></code>, and <code class="xref py py-attr docutils literal notranslate"><span class="pre">received_direction</span></code>. These properties provide the time of flight, path length, and direction of rays at the launch and receiving points respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_path</span> <span class="o">=</span> <span class="n">my_ray_tracer</span><span class="o">.</span><span class="n">solutions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">my_path</span><span class="o">.</span><span class="n">tof</span>
<span class="n">my_path</span><span class="o">.</span><span class="n">path_length</span>
<span class="n">my_path</span><span class="o">.</span><span class="n">emitted_direction</span>
<span class="n">my_path</span><span class="o">.</span><span class="n">received_direction</span>
</pre></div>
</div>
<p><a class="reference internal" href="docstrings/pyrex.RayTracePath.html#pyrex.RayTracePath" title="pyrex.RayTracePath"><code class="xref py py-class docutils literal notranslate"><span class="pre">RayTracePath</span></code></a> also provides a <a class="reference internal" href="docstrings/pyrex.RayTracePath.attenuation.html#pyrex.RayTracePath.attenuation" title="pyrex.RayTracePath.attenuation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RayTracePath.attenuation()</span></code></a> method which gives the attenuation of the signal at a given frequency (or frequencies), and a <a class="reference internal" href="docstrings/pyrex.RayTracePath.coordinates.html#pyrex.RayTracePath.coordinates" title="pyrex.RayTracePath.coordinates"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RayTracePath.coordinates</span></code></a> property which gives the x, y, and z coordinates of the path (useful mostly for plotting, and not guaranteed to be accurate enough for other purposes).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">frequency</span> <span class="o">=</span> <span class="mf">100e6</span> <span class="c1"># Hz</span>
<span class="n">my_path</span><span class="o">.</span><span class="n">attenuation</span><span class="p">(</span><span class="n">frequency</span><span class="p">)</span>
<span class="n">my_path</span><span class="o">.</span><span class="n">attenuation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e8</span><span class="p">,</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_path</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">my_path</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/ray_tracing_1.png" src="_images/ray_tracing_1.png" />
<p>Finally, <a class="reference internal" href="docstrings/pyrex.RayTracePath.propagate.html#pyrex.RayTracePath.propagate" title="pyrex.RayTracePath.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RayTracePath.propagate()</span></code></a> propagates a <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> object from the launch point to the receiving point of the path by applying the frequency-dependent attenuation from <a class="reference internal" href="docstrings/pyrex.RayTracePath.attenuation.html#pyrex.RayTracePath.attenuation" title="pyrex.RayTracePath.attenuation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RayTracePath.attenuation()</span></code></a>, and shifting the signal times by <a class="reference internal" href="docstrings/pyrex.RayTracePath.tof.html#pyrex.RayTracePath.tof" title="pyrex.RayTracePath.tof"><code class="xref py py-attr docutils literal notranslate"><span class="pre">RayTracePath.tof</span></code></a>. Note that it does not apply a 1/R factor to the signal amplitude based on the path length. If needed, this effect should be added in manually. <a class="reference internal" href="docstrings/pyrex.RayTracePath.propagate.html#pyrex.RayTracePath.propagate" title="pyrex.RayTracePath.propagate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RayTracePath.propagate()</span></code></a> returns the <a class="reference internal" href="docstrings/pyrex.Signal.html#pyrex.Signal" title="pyrex.Signal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Signal</span></code></a> objects and polarization vectors of the s-polarized and p-polarized portions of the signal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5e-9</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span>
<span class="n">launch_signal</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pyrex</span><span class="o">.</span><span class="n">FunctionSignal</span><span class="p">(</span><span class="n">time_array</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">1e9</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">FunctionSignal</span><span class="p">(</span><span class="n">time_array</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">1e10</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">launch_signal</span><span class="o">.</span><span class="n">times</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">launch_signal</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1"># Polarize perpendicular to the path in the x-z plane</span>
<span class="n">launch_pol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">my_path</span><span class="o">.</span><span class="n">emitted_direction</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">launch_pol</span><span class="p">)</span>

<span class="n">rec_signals</span><span class="p">,</span> <span class="n">rec_pols</span> <span class="o">=</span> <span class="n">my_path</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">launch_signal</span><span class="p">,</span> <span class="n">polarization</span><span class="o">=</span><span class="n">launch_pol</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rec_signals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">times</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">rec_signals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;s-pol signal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rec_signals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">times</span><span class="o">*</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">rec_signals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;p-pol signal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rec_pols</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/ray_tracing_2.png" src="_images/ray_tracing_2.png" />
<img alt="_images/ray_tracing_3.png" src="_images/ray_tracing_3.png" />
</div>
<div class="section" id="particle-generation">
<span id="id1"></span><h2>Particle Generation<a class="headerlink" href="#particle-generation" title="Permalink to this headline">¶</a></h2>
<p>PyREx includes the <a class="reference internal" href="docstrings/pyrex.Particle.html#pyrex.Particle" title="pyrex.Particle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a> class as a container for information about neutrinos which are generated to produce Askaryan pulses. A <a class="reference internal" href="docstrings/pyrex.Particle.html#pyrex.Particle" title="pyrex.Particle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a> contains an <code class="xref py py-attr docutils literal notranslate"><span class="pre">id</span></code>, a <code class="xref py py-attr docutils literal notranslate"><span class="pre">vertex</span></code>, a <code class="xref py py-attr docutils literal notranslate"><span class="pre">direction</span></code>, an <code class="xref py py-attr docutils literal notranslate"><span class="pre">energy</span></code>, an <code class="xref py py-attr docutils literal notranslate"><span class="pre">interaction</span></code>, and a <code class="xref py py-attr docutils literal notranslate"><span class="pre">weight</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particle_type</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Particle</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">electron_neutrino</span>
<span class="n">initial_position</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># m</span>
<span class="n">direction_vector</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">particle_energy</span> <span class="o">=</span> <span class="mf">1e8</span> <span class="c1"># GeV</span>
<span class="n">particle</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">Particle</span><span class="p">(</span><span class="n">particle_id</span><span class="o">=</span><span class="n">particle_type</span><span class="p">,</span> <span class="n">vertex</span><span class="o">=</span><span class="n">initial_position</span><span class="p">,</span>
                          <span class="n">direction</span><span class="o">=</span><span class="n">direction_vector</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="n">particle_energy</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">interaction</span></code> attribute is an instance of an <code class="xref py py-class docutils literal notranslate"><span class="pre">Interaction</span></code> class (<a class="reference internal" href="docstrings/pyrex.NeutrinoInteraction.html#pyrex.NeutrinoInteraction" title="pyrex.NeutrinoInteraction"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeutrinoInteraction</span></code></a> by default) which is a model for how the neutrino interacts in the ice. It has a <code class="xref py py-attr docutils literal notranslate"><span class="pre">kind</span></code> denoting whether the interaction will be charged-current or neutral-current, an <code class="xref py py-attr docutils literal notranslate"><span class="pre">inelasticity</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">em_frac</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">had_frac</span></code> describing the resulting particle shower(s), and <code class="xref py py-attr docutils literal notranslate"><span class="pre">cross_section</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">interaction_length</span></code> in the ice at the energy of the parent <a class="reference internal" href="docstrings/pyrex.Particle.html#pyrex.Particle" title="pyrex.Particle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="p">)</span>
<span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">kind</span>
<span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">inelasticity</span>
<span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">em_frac</span>
<span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">had_frac</span>
<span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">cross_section</span>
<span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">interaction_length</span>
</pre></div>
</div>
<p>PyREx also includes a number of classes for generating random neutrinos in various ice volumes. The <a class="reference internal" href="docstrings/pyrex.CylindricalGenerator.html#pyrex.CylindricalGenerator" title="pyrex.CylindricalGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">CylindricalGenerator</span></code></a> and <a class="reference internal" href="docstrings/pyrex.RectangularGenerator.html#pyrex.RectangularGenerator" title="pyrex.RectangularGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">RectangularGenerator</span></code></a> classes generate neutrinos uniformly in cylindrical or rectangular volumes respectively. These generator classes take as arguments the necessary dimensions and an energy (which can be a scalar value or a function returning scalar values). Additional arguments include whether to reject events shadowed by the Earth, as well as a desired flavor ratio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">volume_radius</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># m</span>
<span class="n">volume_depth</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># m</span>
<span class="n">flavor_ratio</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># even distribution of neutrino flavors</span>
<span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;astrophysical&#39;</span> <span class="c1"># could also be cosmogenic, changes neutrino:antineutrino ratios</span>
<span class="n">my_generator</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">CylindricalGenerator</span><span class="p">(</span><span class="n">dr</span><span class="o">=</span><span class="n">volume_radius</span><span class="p">,</span>
                                          <span class="n">dz</span><span class="o">=</span><span class="n">volume_depth</span><span class="p">,</span>
                                          <span class="n">energy</span><span class="o">=</span><span class="n">particle_energy</span><span class="p">,</span>
                                          <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">flavor_ratio</span><span class="o">=</span><span class="n">flavor_ratio</span><span class="p">,</span>
                                          <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
<span class="n">my_generator</span><span class="o">.</span><span class="n">create_event</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">create_event()</span></code> method of the generator returns an <a class="reference internal" href="docstrings/pyrex.Event.html#pyrex.Event" title="pyrex.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> object, which contains a tree of <a class="reference internal" href="docstrings/pyrex.Particle.html#pyrex.Particle" title="pyrex.Particle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a> objects representing the event. Currently this tree will only contain a single neutrino, but could be expanded in the future in order to describe more exotic events. The neutrino is available as the only element in the list <code class="xref py py-attr docutils literal notranslate"><span class="pre">Event.roots</span></code>. It can also be accessed by iterating the <a class="reference internal" href="docstrings/pyrex.Event.html#pyrex.Event" title="pyrex.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> object.</p>
<p>Lastly, PyREx includes <a class="reference internal" href="docstrings/pyrex.ListGenerator.html#pyrex.ListGenerator" title="pyrex.ListGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ListGenerator</span></code></a> and <a class="reference internal" href="docstrings/pyrex.FileGenerator.html#pyrex.FileGenerator" title="pyrex.FileGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileGenerator</span></code></a> classes which can be used to reproduce pre-generated events from either a list or from simulation output files, respectively. For example, to continuously re-throw our <a class="reference internal" href="docstrings/pyrex.Particle.html#pyrex.Particle" title="pyrex.Particle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a> object from above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">repetitive_generator</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">ListGenerator</span><span class="p">([</span><span class="n">pyrex</span><span class="o">.</span><span class="n">Event</span><span class="p">(</span><span class="n">particle</span><span class="p">)])</span>
<span class="n">repetitive_generator</span><span class="o">.</span><span class="n">create_event</span><span class="p">()</span>
<span class="n">repetitive_generator</span><span class="o">.</span><span class="n">create_event</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="full-simulation">
<h2>Full Simulation<a class="headerlink" href="#full-simulation" title="Permalink to this headline">¶</a></h2>
<p>PyREx provides the <a class="reference internal" href="docstrings/pyrex.EventKernel.html#pyrex.EventKernel" title="pyrex.EventKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventKernel</span></code></a> class to control a basic simulation including the creation of neutrinos and their respective signals, the propagation of their pulses to the antennas, and the triggering of the antennas. The <a class="reference internal" href="docstrings/pyrex.EventKernel.html#pyrex.EventKernel" title="pyrex.EventKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventKernel</span></code></a> is designed to be modular and can use a specific ice model, ray tracer, output file writer, and signal times array as specified in optional arguments, along with some basic parameters used to speed up the simulation (the defaults are explicitly specified below).</p>
<p>The <a class="reference internal" href="docstrings/pyrex.EventKernel.event.html#pyrex.EventKernel.event" title="pyrex.EventKernel.event"><code class="xref py py-meth docutils literal notranslate"><span class="pre">EventKernel.event()</span></code></a> method handles the full simulation of a single event: generating a random neutrino event with a corresponding Askaryan signal, propagating the signal to each antenna in the detector, and processing the response of the antennas to the incoming signal(s). The method returns the <a class="reference internal" href="docstrings/pyrex.Event.html#pyrex.Event" title="pyrex.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> object simulated and optionally may return whether the detector was triggered by the event.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particle_generator</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">CylindricalGenerator</span><span class="p">(</span><span class="n">dr</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="mf">1e8</span><span class="p">)</span>
<span class="n">detector</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">]):</span>
    <span class="n">detector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">pyrex</span><span class="o">.</span><span class="n">DipoleAntenna</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;antenna_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span>
                            <span class="n">center_frequency</span><span class="o">=</span><span class="mf">250e6</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="mf">300e6</span><span class="p">,</span>
                            <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">resistance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">effective_height</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                            <span class="n">trigger_threshold</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">noisy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">)</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">EventKernel</span><span class="p">(</span><span class="n">generator</span><span class="o">=</span><span class="n">particle_generator</span><span class="p">,</span>
                           <span class="n">antennas</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
                           <span class="n">ice_model</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">ice</span><span class="p">,</span>
                           <span class="n">ray_tracer</span><span class="o">=</span><span class="n">pyrex</span><span class="o">.</span><span class="n">RayTracer</span><span class="p">,</span>
                           <span class="n">signal_times</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">50e-9</span><span class="p">,</span> <span class="mf">50e-9</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span>
                                                    <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                           <span class="n">event_writer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">triggers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">offcone_max</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">weight_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">attenuation_interpolation</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">triggered</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">triggered</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">antenna</span> <span class="ow">in</span> <span class="n">detector</span><span class="p">:</span>
        <span class="n">antenna</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">antenna</span> <span class="ow">in</span> <span class="n">detector</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">antenna</span><span class="o">.</span><span class="n">is_hit</span><span class="p">:</span>
            <span class="n">triggered</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>

<span class="n">particle</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">roots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Particle type:   &quot;</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shower vertex:   &quot;</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">vertex</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shower axis:     &quot;</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Particle energy: &quot;</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Interaction type:&quot;</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">kind</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Electromagnetic shower fraction:&quot;</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">em_frac</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hadronic shower fraction:       &quot;</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">interaction</span><span class="o">.</span><span class="n">had_frac</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Event weight:&quot;</span><span class="p">,</span> <span class="n">particle</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>

<span class="k">for</span> <span class="n">antenna</span> <span class="ow">in</span> <span class="n">detector</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">wave</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">antenna</span><span class="o">.</span><span class="n">waveforms</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wave</span><span class="o">.</span><span class="n">times</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span> <span class="n">wave</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time (ns)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Voltage (V)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">antenna</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; - waveform &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/full_sim_1.png" src="_images/full_sim_1.png" />
<img alt="_images/full_sim_2.png" src="_images/full_sim_2.png" />
</div>
<div class="section" id="data-file-i-o">
<h2>Data File I/O<a class="headerlink" href="#data-file-i-o" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="docstrings/pyrex.File.html#pyrex.File" title="pyrex.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> class controls the reading and writing of data files for simulation. At the most basic it takes a filename and mode in which to open the file, and if the file type is supported the object will be the appropriate file handler. Like python’s <code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code> function, the <a class="reference internal" href="docstrings/pyrex.File.html#pyrex.File" title="pyrex.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> class works as a context manager and should preferably be used in <code class="xref py py-const docutils literal notranslate"><span class="pre">with</span></code> statements. Currently the only data file type supported by PyREx is HDF5. Depending on whether an HDF5 file is being read or written there are additional keyword arguments that may be provided to <a class="reference internal" href="docstrings/pyrex.File.html#pyrex.File" title="pyrex.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a>. HDF5 files support the following modes: ‘r’ for read-only, ‘w’ for write (overwrites existing file), ‘a’/’r+’ for append (doesn’t overwrite existing file), and ‘x’ for write (fails if file exists already).</p>
<p>If writing an HDF5 file, the optional arguments specify which event data to write. The available write options are <code class="docutils literal notranslate"><span class="pre">write_particles</span></code>, <code class="docutils literal notranslate"><span class="pre">write_triggers</span></code>, <code class="docutils literal notranslate"><span class="pre">write_antenna_triggers</span></code>, <code class="docutils literal notranslate"><span class="pre">write_rays</span></code>, <code class="docutils literal notranslate"><span class="pre">write_noise</span></code>, and <code class="docutils literal notranslate"><span class="pre">write_waveforms</span></code>. Most of these are self-explanatory, but <code class="docutils literal notranslate"><span class="pre">write_antenna_triggers</span></code> will write triggering information for each antenna in the detector and <code class="docutils literal notranslate"><span class="pre">write_noise</span></code> will write the frequency data required to replicate noise waveforms. The last optional argument is <code class="docutils literal notranslate"><span class="pre">require_trigger</span></code> which specifies which data should only be written when the detector is triggered. If a boolean value, requires trigger or not for all data with the exception of particle and trigger data, which is always written. If a list of strings, the listed data will require triggers and any other data will always be written.</p>
<p>The most straightforward way to write data files is to pass a <a class="reference internal" href="docstrings/pyrex.File.html#pyrex.File" title="pyrex.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> object to the <a class="reference internal" href="docstrings/pyrex.EventKernel.html#pyrex.EventKernel" title="pyrex.EventKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventKernel</span></code></a> object handling the simulation. In such a case, a global trigger condition should be passed to the <a class="reference internal" href="docstrings/pyrex.EventKernel.html#pyrex.EventKernel" title="pyrex.EventKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">EventKernel</span></code></a> as well, either as a function which acts on a detector object, or as the “global” key in a dictionary of functions representing various trigger conditions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">particle_generator</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">CylindricalGenerator</span><span class="p">(</span><span class="n">dr</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">dz</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="mf">1e8</span><span class="p">)</span>
<span class="n">detector</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">]):</span>
    <span class="n">detector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">pyrex</span><span class="o">.</span><span class="n">DipoleAntenna</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;antenna_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">),</span>
                            <span class="n">center_frequency</span><span class="o">=</span><span class="mf">250e6</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="mf">300e6</span><span class="p">,</span>
                            <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">resistance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">effective_height</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                            <span class="n">trigger_threshold</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">noisy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">global_trigger_condition</span><span class="p">(</span><span class="n">det</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ant</span> <span class="ow">in</span> <span class="n">det</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ant</span><span class="o">.</span><span class="n">is_hit</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">even_antenna_trigger</span><span class="p">(</span><span class="n">det</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ant</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">det</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ant</span><span class="o">.</span><span class="n">is_hit</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>

<span class="n">trigger_conditions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;global&quot;</span><span class="p">:</span> <span class="n">global_trigger_condition</span><span class="p">,</span>
    <span class="s2">&quot;evens&quot;</span><span class="p">:</span> <span class="n">even_antenna_trigger</span><span class="p">,</span>
    <span class="s2">&quot;ant1&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">det</span><span class="p">:</span> <span class="n">det</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">is_hit</span>
<span class="p">}</span>

<span class="k">with</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;my_data_file.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">EventKernel</span><span class="p">(</span><span class="n">generator</span><span class="o">=</span><span class="n">particle_generator</span><span class="p">,</span>
                               <span class="n">antennas</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
                               <span class="n">event_writer</span><span class="o">=</span><span class="n">f</span><span class="p">,</span>
                               <span class="n">triggers</span><span class="o">=</span><span class="n">trigger_conditions</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">antenna</span> <span class="ow">in</span> <span class="n">detector</span><span class="p">:</span>
            <span class="n">antenna</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">event</span><span class="p">,</span> <span class="n">triggered</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">triggered</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to manually write the data file, then the <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.set_detector()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.add()</span></code> methods are necessary. <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.set_detector()</span></code> associates the given antennas with the file object (and writes their data) and <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.add()</span></code> adds the data from the given event to the file. Here we also manually open and close the file object with <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.open()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.close()</span></code>, and add some metadata to the file with <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.add_file_metadata()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;my_data_file_2.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>

<span class="n">f</span><span class="o">.</span><span class="n">add_file_metadata</span><span class="p">({</span><span class="s2">&quot;write_style&quot;</span><span class="p">:</span> <span class="s2">&quot;manual&quot;</span><span class="p">,</span> <span class="s2">&quot;number_of_events&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">f</span><span class="o">.</span><span class="n">set_detector</span><span class="p">(</span><span class="n">detector</span><span class="p">)</span>

<span class="n">kernel</span> <span class="o">=</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">EventKernel</span><span class="p">(</span><span class="n">generator</span><span class="o">=</span><span class="n">particle_generator</span><span class="p">,</span>
                           <span class="n">antennas</span><span class="o">=</span><span class="n">detector</span><span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">antenna</span> <span class="ow">in</span> <span class="n">detector</span><span class="p">:</span>
        <span class="n">antenna</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">kernel</span><span class="o">.</span><span class="n">event</span><span class="p">()</span>
    <span class="n">triggered</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">antenna</span> <span class="ow">in</span> <span class="n">detector</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">antenna</span><span class="o">.</span><span class="n">is_hit</span><span class="p">:</span>
            <span class="n">triggered</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>
    <span class="n">f</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">triggered</span><span class="o">=</span><span class="n">triggered</span><span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="docstrings/pyrex.File.html#pyrex.File" title="pyrex.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> objects also support writing miscellaneous analysis data to the file. <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.create_analysis_dataset()</span></code> creates and returns a basic HDF5 dataset. <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.create_analysis_metadataset()</span></code> creates a joined set of tables for string and float data, which can be written to with <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.add_analysis_metadata()</span></code>. And finally, <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.add_analysis_indices()</span></code> allows for linking event indices to specific rows of analysis data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;my_data_file.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">create_analysis_metadataset</span><span class="p">(</span><span class="s2">&quot;effective_volume&quot;</span><span class="p">)</span>
    <span class="n">gen_vol</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">1000</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span>
    <span class="c1"># Just set an arbitrary number of triggers for now. We&#39;ll get into reading</span>
    <span class="c1"># files in the examples below.</span>
    <span class="n">n_triggers</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;generation_volume&quot;</span><span class="p">:</span> <span class="n">gen_vol</span><span class="p">,</span>
        <span class="s2">&quot;veff&quot;</span><span class="p">:</span> <span class="n">n_triggers</span><span class="o">/</span><span class="mi">10</span><span class="o">*</span><span class="n">gen_vol</span><span class="p">,</span>
        <span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_triggers</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="o">*</span><span class="n">gen_vol</span><span class="p">,</span>
        <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="s2">&quot;m^3&quot;</span>
    <span class="p">}</span>
    <span class="n">f</span><span class="o">.</span><span class="n">add_analysis_metadata</span><span class="p">(</span><span class="s2">&quot;effective_volume&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="n">other</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">create_analysis_dataset</span><span class="p">(</span><span class="s2">&quot;meaningless_data&quot;</span><span class="p">,</span>
                                      <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
    <span class="n">other</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;rows_per_event&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">f</span><span class="o">.</span><span class="n">add_analysis_indices</span><span class="p">(</span><span class="s2">&quot;meaningless_data&quot;</span><span class="p">,</span> <span class="n">global_index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                               <span class="n">start_index</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>If reading an HDF5 file, the <code class="docutils literal notranslate"><span class="pre">slice_range</span></code> argument specifies the size of event slices to load into memory at once when iterating over events. In general, increasing the <code class="docutils literal notranslate"><span class="pre">slice_range</span></code> will improve the speed of iteration at the cost of greater memory consumption. By default, the whole file is read at once.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;my_data_file.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">slice_range</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>When reading HDF5 files, there are a number of methods and attributes available to access the data. With the <a class="reference internal" href="docstrings/pyrex.File.html#pyrex.File" title="pyrex.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> object alone, <code class="xref py py-attr docutils literal notranslate"><span class="pre">File.file_metadata</span></code> contains a dictionary of the file’s metadata and <code class="xref py py-attr docutils literal notranslate"><span class="pre">File.antenna_info</span></code> contains a list of dictionaries with data for each antenna in the detector the file was run with. If waveform data is available, <code class="xref py py-meth docutils literal notranslate"><span class="pre">File.get_waveforms()</span></code> can be used to get all waveforms in the file or a specific subset based on <code class="docutils literal notranslate"><span class="pre">event_id</span></code>, <code class="docutils literal notranslate"><span class="pre">antenna_id</span></code>, and <code class="docutils literal notranslate"><span class="pre">waveform_type</span></code> arguments. Finally, direct access to the contents of the HDF5 file is supported through either the proper paths or nicknames.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;my_data_file.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">file_metadata</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">antenna_info</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># No waveform data was stored above, so these will fail if run</span>
    <span class="c1"># All waveforms:</span>
    <span class="c1"># wfs = f.get_waveforms()</span>
    <span class="c1"># Waveforms from event 0</span>
    <span class="c1"># wfs = f.get_waveforms(event_id=0)</span>
    <span class="c1"># Waveforms in antenna 1 from all events</span>
    <span class="c1"># wfs = f.get_waveforms(antenna_id=1)</span>
    <span class="c1"># Direct waveform in antenna 4 from event 5</span>
    <span class="c1"># wf = f.get_waveforms(event_id=5, antenna_id=4, waveform_type=0)</span>

    <span class="c1"># Using full file path</span>
    <span class="n">triggers</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;data/triggers&#39;</span><span class="p">]</span>
    <span class="c1"># Using dataset nickname</span>
    <span class="n">particle_string_metadata</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;particles_meta_str&#39;</span><span class="p">]</span>
    <span class="c1"># Using analysis dataset nickname</span>
    <span class="n">other</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;meaningless_data&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>HDF5 files opened in read-only mode can also be iterated over, which allows access to the data for each event in turn. When iterating, the event objects have the following methods for accessing data. <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_particle_info()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_rays_info()</span></code> return a list of dictionaries or attribute values for the event’s particles or rays, respectively. The <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_neutrino</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">is_nubar</span></code>, and <code class="xref py py-attr docutils literal notranslate"><span class="pre">flavor</span></code> attributes also contain the associated basic information about the base particle of the event. <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_waveforms()</span></code> returns the waveforms for the event, or a specific subset based on <code class="docutils literal notranslate"><span class="pre">antenna_id</span></code> and <code class="docutils literal notranslate"><span class="pre">waveform_type</span></code> (as above). The <code class="xref py py-attr docutils literal notranslate"><span class="pre">triggered</span></code> attribute contains whether the event triggered the detector and the <code class="xref py py-meth docutils literal notranslate"><span class="pre">get_triggered_components()</span></code> method returns a list of the trigger conditions of the detector which were met (as specified when writing the file). And finally, if noise data is recorded for the event it is contained in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">noise_bases</span></code> attribute. Iteration of the HDF5 files supports slicing as long as the step size is positive-valued, and individual events can also be reached by indexing the <a class="reference internal" href="docstrings/pyrex.File.html#pyrex.File" title="pyrex.File"><code class="xref py py-class docutils literal notranslate"><span class="pre">File</span></code></a> object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pyrex</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="s1">&#39;my_data_file.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">is_neutrino</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">is_nubar</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">flavor</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">triggered</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">get_triggered_components</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">get_particle_info</span><span class="p">(</span><span class="s1">&#39;particle_name&#39;</span><span class="p">),</span>
              <span class="n">event</span><span class="o">.</span><span class="n">get_particle_info</span><span class="p">(</span><span class="s1">&#39;vertex&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">get_rays_info</span><span class="p">(</span><span class="s1">&#39;receiving_angle&#39;</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">get_rays_info</span><span class="p">(</span><span class="s1">&#39;tof&#39;</span><span class="p">))</span>

    <span class="c1"># No waveform data was stored above, so this will fail if run</span>
    <span class="c1"># wfs = f[4].get_waveforms(antenna_id=2)</span>
</pre></div>
</div>
</div>
<div class="section" id="more-examples">
<h2>More Examples<a class="headerlink" href="#more-examples" title="Permalink to this headline">¶</a></h2>
<p>For more code examples, see the <a class="reference internal" href="examples.html#example-code"><span class="std std-ref">Example Code</span></a> section and the python notebooks and scripts in the examples directory.</p>
</div>
</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PyREx</a></h1>



<p class="blurb">A Python package for simulation of neutrinos and radio antennas in ice.
Version 1.10.0</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=bhokansonfasig&repo=pyrex&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<div id="searchbox" style="display: none" role="search">
<h3>Quick search</h3>
  <div class="searchformwrapper">
  <form class="search" action="search.html" method="get">
    <input type="text" name="q" />
    <input type="submit" value="Go" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
  </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About PyREx</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to Use PyREx</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#working-with-signal-objects">Working with Signal Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#antenna-class-and-subclasses">Antenna Class and Subclasses</a></li>
<li class="toctree-l2"><a class="reference internal" href="#antennasystem-and-detector-classes">AntennaSystem and Detector Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ice-and-earth-models">Ice and Earth Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ray-tracing">Ray Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#particle-generation">Particle Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#full-simulation">Full Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-file-i-o">Data File I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-examples">More Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="customize.html">Custom Sub-Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to PyREx</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">PyREx API</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Version History</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/bhokansonfasig/pyrex">Source (GitHub)</a></li>
    
    <li class="toctree-l1"><a href="https://github.com/bhokansonfasig/pyrex/issues">Report an Issue</a></li>
    
</ul>

        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2021, Ben Hokanson-Fasig.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.5.4.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>